
;===============================================
L_Calculator_State_Involution_Number_Input_Prog:
    LDA     P_Scankey_value
    CMP     #MAX_Number_Input
    BCC     L_Calculator_State_Involution_Number_Input_Prog_Input_Number
    CMP     #D_NUM_Equal_Press

L_Calculator_State_Involution_Number_Input_Prog:
    LDA     P_Scankey_value
    CMP     #MAX_Number_Input
    BCC     L_Calculator_State_Involution_Number_Input_Prog_Input_Number
    CMP     #D_NUM_Equal_Press
    BEQ     L_Calculator_State_Involution_Number_Input_Prog_Equal_Press

    JSR     L_Output_Prog_Involution_IN_Symbol

    JSR     Calculator_Input
    LDA     #Calculator_State_Involution_Input_Symbol;此时按下加减乘除键
    STA     Calculator_State;此时BUF1,BUF2已将运算值存储
    
    LDA     Calculator_Symbol_State
    STA     OP
    LDA     #0
    STA     R_Involution
    JSR     Calculator_Input
    JSR     L_Clear_BBUF_Prog
    JSR     L_Clear_BUF2_FD_Prog
    JSR     L_COPY_BUF1_TO_BUF2_FD

    RTS


L_Calculator_State_Involution_Number_Input_Prog_Equal_Press:
    LDA     #Calculator_State_Involution_Equal_Press
    STA     Calculator_State
    LDA     #Calc_First_Output_Involution_IN
    STA     Calculator_State_Mechine
    LDA     #State_Equal
    STA     Calculator_Symbol_State
    RTS    
;==================================================
L_Calculator_State_Involution_Symbol:
    LDA     Calculator_Symbol_State
    STA     P_Temp+6
    JSR     Calculator_Input
    LDA     P_Scankey_value
    CMP     #D_NUM_Equal_Press
    BEQ     L_Calculator_State_Involution_Symbol_Equal
    CMP     #MAX_Number_Input
    BCC     L_Calculator_State_Involution_Symbol_Number
    LDA     #Calculator_State_Symbol_First_Press;一旦符号键按下，将IBUF的内容传送到，BUF1中
    STA     Calculator_State
    
    LDA     Calculator_Symbol_State
    STA     OP
    CMP     P_Temp+6
    BNE     L_Calculator_State_Involution_Symbol_RTS
    JSR     L_Display_lcd_Involution_Prog
    JSR     L_Copy_BUF1_TO_BBUF_Prog
    LDA     #Calculator_State_Involution
    STA     R_Involution
    STA     Calculator_State
L_Calculator_State_Involution_Symbol_RTS:
    RTS
L_Calculator_State_Involution_Symbol_Equal:
    JSR     L_Calculator_Calc_Prog
    JSR     L_Display_Calculator_Output 
   
    LDA     #Calculator_State_Equal_Press
    STA     Calculator_State
    JSR     L_Clr_Calculator_Symbol_Prog
    RTS
L_Calculator_State_Involution_Symbol_Number:
    LDA     #Calculator_State_Input;设置
    STA     Calculator_State
    LDA     Calculator_Symbol_State
    STA     OP
    JSR     L_Clear_IBUF_FD_Prog
    JSR     Calculator_Input
    RTS

;================================================================
L_Calculator_State_Involution_Equal_Press_After:
    LDA     P_Scankey_value
    CMP     #D_NUM_Equal_Press
    BEQ     L_Calculator_State_Involution_Equal_Press_After_Equal_Press
    CMP     #MAX_Number_Input
    BCC     L_Calculator_State_Involution_Equal_Press_After_Number_Input
    LDA     #Calculator_State_Involution_Input_Symbol;此时按下加减乘除键
    STA     Calculator_State;此时BUF1,BUF2已将运算值存储
    JSR     L_Clear_BBUF_Prog
    JSR     L_Clear_IBUF_FD_Prog
    LDA     #0
    STA     R_Involution
    JSR     Calculator_Input
    LDA     Calculator_Symbol_State
    STA     OP
    JSR     L_COPY_BUF1_TO_BUF2_FD
    RTS




L_Calculator_State_Involution_Equal_Press_After_Equal_Press:
    LDA     #Calc_First_Output_Involution
    STA     Calculator_State_Mechine
    JSR     Calculator_Input

    LDA     #Calculator_State_Involution_Equal_Press
    STA     Calculator_State
    RTS


L_Calculator_State_Involution_Equal_Press_After_Number_Input:
    JSR     L_Clear_IBUF_FD_Prog
    LDA     #Calculator_State_Involution_Equal_Press_Input_Number
    STA     Calculator_State
L_Calculator_State_Involution_Equal_Press_After_Input_Number_1:
    JSR     Calculator_Input
    RTS


L_Calculator_State_Involution_Equal_Press_After_Input_Number:
    LDA     P_Scankey_value
    CMP     #D_NUM_Equal_Press
    BEQ     L_Calculator_State_Involution_Equal_Press_After_Equal_Press
    CMP     #MAX_Number_Input
    BCC     L_Calculator_State_Involution_Equal_Press_After_Input_Number_1
    LDA     #Calculator_State_Involution_Input_Symbol;此时按下加减乘除键
    STA     Calculator_State;此时BUF1,BUF2已将运算值存储
    JSR     L_Clear_BBUF_Prog
    JSR     L_Clear_IBUF_FD_Prog
    LDA     #0
    STA     R_Involution
    JSR     Calculator_Input
    JSR     L_COPY_BUF1_TO_BUF2_FD
    LDA     Calculator_Symbol_State
    STA     OP
    RTS